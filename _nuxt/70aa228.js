(window.webpackJsonp=window.webpackJsonp||[]).push([[25,10],{287:function(t,e,n){"use strict";n.r(e),n.d(e,"ARmod",(function(){return r}));n(32),n(29);var o=n(280),r=function(){function t(){this.title="untitled",this.scale=30,this.maxScale=100,this.minScale=5,this.stepScale=5,this.mixers=[]}var e=t.prototype;return e.setARForm=function(t){this.arForm=t},e.setScene=function(){this.clock=new o.l,this.scene=new o.ib,this.totalTime=0,this.renderer=new o.ub({canvas:document.querySelector("#iz-arkit-threejs"),antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(new o.m("lightgrey"),0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.outputEncoding=o.t;this.markerRoot=new o.u,this.markerRoot.name="marker",this.scene.add(this.markerRoot)},e.getCanvasRelativePosition=function(t){var e,n,rect=document.getElementById("iz-arkit-threejs").getBoundingClientRect(),o=parseInt(document.getElementById("iz-arkit-threejs").style.width,10),r=parseInt(document.getElementById("iz-arkit-threejs").style.height,10);return t instanceof MouseEvent?(e=(t.clientX-rect.left)*o/rect.width,n=(t.clientY-rect.top)*r/rect.height):t instanceof TouchEvent&&(e=(t.changedTouches[0].pageX-rect.left)*o/rect.width,n=(t.changedTouches[0].pageY-rect.top)*r/rect.height),[e,n]},e.setLight=function(){var t=new o.a(16777215,5);this.scene.add(t)},e.setCamera=function(){var t=this;this.camera=new o.Z,this.scene.add(this.camera),this.arToolkitContext=new THREEx.ArToolkitContext({cameraParametersUrl:"/media-exp-ts/camera_para.dat"}),this.arToolkitContext.init((function(){t.camera.projectionMatrix.copy(t.arToolkitContext.getProjectionMatrix())})),this.arToolkitSource=new THREEx.ArToolkitSource({sourceType:"webcam"}),this.arToolkitSource.init((function(){var t=0,e=setInterval((function(){++t>20&&clearInterval(e),n()}),100)}));var e=this;function n(){e.arToolkitSource.onResizeElement(),e.arToolkitSource.copyElementSizeTo(e.renderer.domElement),null!==e.arToolkitContext.arController&&e.arToolkitSource.copyElementSizeTo(e.arToolkitContext.arController.canvas)}window.addEventListener("resize",(function(){n()}));new THREEx.ArMarkerControls(this.arToolkitContext,this.markerRoot,{type:"pattern",patternUrl:"/media-exp-ts/3Dmarker/hiro.patt",changeMatrixMode:"modelViewMatrix"})},e.setMarker=function(){new THREEx.ArMarkerControls(this.arToolkitContext,this.markerRoot,{type:"pattern",patternUrl:"/media-exp-ts/3Dmarker/hiro.patt",changeMatrixMode:"modelViewMatrix"})},e.setObject=function(){},e.setSysObject=function(){var t=new o.f(1,1,1),e=new o.P;this.calcCube=new o.N(t,e),this.calcCube.scale.set(0,0,0),this.markerRoot.add(this.calcCube)},e.setEvent=function(){},e.update=function(){this.arToolkitSource.ready&&this.arToolkitContext.update(this.arToolkitSource.domElement)},e.render=function(){this.renderer.render(this.scene,this.camera)},e.animate=function(){requestAnimationFrame(this.animate.bind(this));var t=this.clock.getDelta();this.totalTime+=this.clock.getDelta(),this.update(),this.render();for(var i=0;i<this.mixers.length;i++)this.mixers[i].update(t)},e.world2screenPos=function(t,e,n){this.calcCube.position.set(t,e,n);var r=parseInt(document.getElementById("iz-arkit-threejs").style.width,10),c=parseInt(document.getElementById("iz-arkit-threejs").style.height,10),l=this.calcCube.getWorldPosition(new o.sb).project(this.camera),rect=document.getElementById("iz-arkit-threejs").getBoundingClientRect(),h=r*(l.x+1)/2,d=c*(1-l.y)/2;return{x:h=h*rect.width/r+rect.left,y:d=d*rect.height/c+rect.top}},e.screen2worldPos=function(t){var e=parseInt(document.getElementById("iz-arkit-threejs").style.width,10),n=parseInt(document.getElementById("iz-arkit-threejs").style.height,10),r=this.getCanvasRelativePosition(t),c=1.08*(r[0]/e*2-1),l=.81*(-r[1]/n*2+1);return c=Math.min(Math.max(c,-1),1),l=Math.min(Math.max(l,-1),1),new o.rb(c,l)},e.getObjName=function(t){var e=this.screen2worldPos(t),n="",r=new o.gb;r.setFromCamera(e,this.camera);for(var c,l=r.intersectObjects(this.scene.children,!0),i=0;i<l.length;i++){for(var h=(c=l[i].object).name;c.parent.name!==this.markerRoot.name;)c=c.parent;if(1==c.visible){n=h;break}}return n},e.getThreeObjName=function(t){var e=this.screen2worldPos(t),n="",r=new o.gb;r.setFromCamera(e,this.camera);for(var c,l=r.intersectObjects(this.scene.children,!0),i=0;i<l.length;i++){for(c=l[i].object;c.parent.name!==this.markerRoot.name;)c=c.parent;if(1==c.visible){n=c.name;break}}return n},e.act_zoomIn=function(){if(this.scale<this.maxScale){this.scale;this.scale=this.scale>=this.maxScale?this.maxScale:this.scale+this.stepScale;for(var i=0;i<this.scene.children.length;i++)if("Group"==this.scene.children[i].type)for(var t=0;t<this.scene.children[i].children.length;t++){this.scene.children[i].children[t].scale.set(this.scale/100,this.scale/100,this.scale/100)}this.calcCube.scale.set(0,0,0)}},e.act_zoomOut=function(){if(this.scale>=this.minScale){this.scale;this.scale=this.scale<=this.minScale?this.minScale:this.scale-this.stepScale;for(var i=0;i<this.scene.children.length;i++)if("Group"==this.scene.children[i].type)for(var t=0;t<this.scene.children[i].children.length;t++){this.scene.children[i].children[t].scale.set(this.scale/100,this.scale/100,this.scale/100)}this.calcCube.scale.set(0,0,0)}},t}()},291:function(t,e,n){"use strict";function o(t,p){return(o=Object.setPrototypeOf||function(t,p){return t.__proto__=p,t})(t,p)}function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}n.d(e,"a",(function(){return r}))},334:function(t,e,n){var content=n(389);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(31).default)("6e6dfa50",content,!0,{sourceMap:!1})},388:function(t,e,n){"use strict";n(334)},389:function(t,e,n){var o=n(30)(!1);o.push([t.i,"#display-rotate{position:absolute;top:0;left:0;z-index:255;width:100%;height:100%}",""]),t.exports=o},415:function(t,e,n){"use strict";n.r(e),n.d(e,"AR",(function(){return f}));var o=n(291),r=(n(281),n(32),n(1)),c=n(280),l=n(286),h=n(313),d=n(287),m=r.a.extend({layout:"ar",data:function(){return{ar:void 0}},components:{ARKit:h.default},created:function(){},mounted:function(){"ar"===this.$nuxt.layoutName&&this.init()},methods:{init:function(){var t=this.$refs.arkit;this.ar=new f,this.ar.title="rotateTest",t.setAR(this.ar)}}}),f=function(t){function e(){var e;return(e=t.call(this)||this).title="untitled",e.title="rotateTest",e.scale=30,e.console=Array(4).fill(""),e.stickFlag=!1,e.rotateCount=0,e.rotatePos=0,e}Object(o.a)(e,t);var n=e.prototype;return n.setARFrom=function(t){this.arForm=t},n.setLight=function(){var t=new c.ab(16777215,1);t.position.set(-25,0,-20),this.scene.add(t),(t=new c.ab(16777215,1)).position.set(25,0,-20),this.scene.add(t),(t=new c.ab(16777215,1)).position.set(0,0,23.25),this.scene.add(t),(t=new c.ab(16777215,1)).position.set(0,20.4,-20),this.scene.add(t)},n.setObject=function(){var t=this,e=this.scale/100,n=new c.f(1,1,1),o=new c.P;this.calcCube=new c.N(n,o),this.calcCube.scale.set(0,0,0),this.markerRoot.add(this.calcCube);var r=new l.a;r.load("/media-exp-ts/3Dmodels/rotateTest/stick.glb",(function(data){t.stick=data.scene,t.stick.name="*Stick",t.stick.scale.set(e,e,e),t.stick.position.set(0,0,0),t.markerRoot.add(t.stick)})),r.load("/media-exp-ts/3Dmodels/rotateTest/pipe.glb",(function(data){t.pipe=data.scene,t.pipe.name="*Pipe",t.pipe.scale.set(e,e,e),t.pipe.position.set(0,0,0),t.markerRoot.add(t.pipe)})),r.load("/media-exp-ts/3Dmodels/rotateTest/box.glb",(function(data){var n=data.scene;n.name="*Box",n.scale.set(e,e,e),n.position.set(0,0,0),t.markerRoot.add(n)}))},n.setEvent=function(){var t=this,e=this;document.addEventListener("mousedown",(function(n){var o=t.screen2worldPos(n),r=new c.gb;r.setFromCamera(o,t.camera);var l,h=r.intersectObjects(e.scene.children,!0);if(h[0]){for(l=h[0].object;l.parent.name!==t.markerRoot.name;)l=l.parent;t.console[0]="[Collision] "+l.name}else t.console[0]="[Collision] none"}),!1),document.addEventListener("touchstart",(function(e){"*Stick"===t.getThreeObjName(e)&&(t.stickFlag=!0)})),document.addEventListener("touchend",(function(){t.stickFlag=!1})),document.addEventListener("touchmove",(function(e){if(t.stickFlag){var n=t.world2screenPos(0,2*t.scale/100,0),o=t.world2screenPos(1,2*t.scale/100,0),r={x:o.x-n.x,y:o.y-n.y},c=Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2));r={x:r.x/c,y:r.y/c};var l={x:(o=t.world2screenPos(0,2*t.scale/100,-1)).x-n.x,y:o.y-n.y};c=Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2)),l={x:l.x/c,y:l.y/c};var h={x:e.changedTouches[0].pageX-n.x,y:e.changedTouches[0].pageY-n.y};c=Math.sqrt(Math.pow(h.x,2)+Math.pow(h.y,2)),h={x:h.x/c,y:h.y/c};var d,m=r.x*h.x+r.y*h.y,f=l.x*h.x+l.y*h.y,y=f<0?-Math.acos(m):Math.acos(m);t.console[2]="[Angle] "+y,t.stick.rotation.y=y,t.pipe.rotation.y=y,0==(d=m>=0?f>=0?3:0:f>=0?2:1)&&3==t.rotatePos&&(t.rotateCount+=1),3==d&&0==t.rotatePos&&(t.rotateCount-=1),t.rotatePos=d,t.rotateCount>=0?t.console[3]="[RotateCounter] "+t.rotateCount:t.console[3]="[RotateCounter] "+(t.rotateCount+1)}})),this.initRotate()},n.initRotate=function(){var t=document.getElementById("display-rotate");t.width=window.innerWidth,t.height=window.innerHeight,this.displayVector()},n.displayVector=function(){requestAnimationFrame(this.displayVector.bind(this));var t=document.getElementById("display-rotate").getContext("2d");t.clearRect(0,0,window.innerWidth,window.innerHeight);var e=this.world2screenPos(0,2*this.scale/100,0);this.console[1]="[OriginPosition] x:"+Math.floor(e.x)+"y:"+Math.floor(e.y),t.fillStyle="rgba(255,0,0,1)",t.beginPath(),t.arc(e.x,e.y,10,0,2*Math.PI),t.closePath(),t.fill();var n=this.world2screenPos(1,2*this.scale/100,0);t.fillStyle="rgba(0,0,255,1)",t.beginPath(),t.arc(n.x,n.y,10,0,2*Math.PI),t.closePath(),t.fill();var o={x:n.x-e.x,y:n.y-e.y},r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2));o={x:o.x/r,y:o.y/r},n=this.world2screenPos(0,2*this.scale/100,-1),t.fillStyle="rgba(0,255,0,1)",t.beginPath(),t.arc(n.x,n.y,10,0,2*Math.PI),t.closePath(),t.fill();var c={x:n.x-e.x,y:n.y-e.y};r=Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2)),c={x:c.x/r,y:c.y/r},t.strokeStyle="rgba(255,0,0,1)",t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+200*o.x,e.y+200*o.y),t.moveTo(e.x,e.y),t.lineTo(e.x+200*o.y,e.y-200*o.x),t.closePath(),t.stroke()},e}(d.ARmod),y=m,x=(n(388),n(12)),component=Object(x.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("canvas",{attrs:{id:"display-rotate"}}),t._v(" "),n("ARKit",{ref:"arkit",staticStyle:{"z-index":"1"}})],1)}),[],!1,null,null,null);e.default=component.exports}}]);