(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{281:function(e,t,n){var r=n(3),o=n(282),d=n(109);r({target:"Array",proto:!0},{fill:o}),d("fill")},282:function(e,t,n){"use strict";var r=n(18),o=n(75),d=n(13);e.exports=function(e){for(var t=r(this),n=d(t.length),l=arguments.length,c=o(l>1?arguments[1]:void 0,n),h=l>2?arguments[2]:void 0,m=void 0===h?n:o(h,n);m>c;)t[c++]=e;return t}},332:function(e,t,n){"use strict";n.r(t),n.d(t,"AR",(function(){return o}));n(29),n(281);var r=n(280),o=function(){function e(){this.init(),this.animate()}var t=e.prototype;return t.init=function(){var e=this;this.adjustMode=0,this.markerEnable=!1,this.clock=new r.l,this.scene=new r.ib;var t=new r.a(16777215,1);this.scene.add(t),this.camera=new r.Z,this.scene.add(this.camera),this.totalTime=0,this.renderer=new r.ub({canvas:document.querySelector("#three-canvas"),antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(new r.m("lightgrey"),0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.outputEncoding=r.t,document.body.appendChild(this.renderer.domElement),this.arToolkitContext=new THREEx.ArToolkitContext({cameraParametersUrl:"/media-exp-ts/camera_para.dat"}),this.arToolkitContext.init((function(){e.camera.projectionMatrix.copy(e.arToolkitContext.getProjectionMatrix())}));var n=this;function o(){n.arToolkitSource.onResizeElement(),n.arToolkitSource.copyElementSizeTo(n.renderer.domElement),document.getElementById("col-canvas").width=window.innerWidth,document.getElementById("col-canvas").height=window.innerHeight,null!==n.arToolkitContext.arController&&n.arToolkitSource.copySizeTo(n.arToolkitContext.arController.canvas)}this.arToolkitSource=new THREEx.ArToolkitSource({sourceType:"webcam"}),this.arToolkitSource.init((function(){var e=0,t=setInterval((function(){++e>20&&clearInterval(t),o()}),100)})),window.addEventListener("resize",(function(){o()}));var d=new r.u;this.scene.add(d);var l=new THREEx.ArMarkerControls(this.arToolkitContext,d,{type:"pattern",patternUrl:"/media-exp-ts/3Dmarker/hiro.patt",changeMatrixMode:"modelViewMatrix"});l.addEventListener("getMarker",(function(e){console.log(e)})),l.addEventListener("markerFound",(function(){e.markerEnable=!0,console.log(l.markerVisible)})),l.addEventListener("markerLost",(function(){e.markerEnable=!1}));var c=new r.f(1,1,1),h=new r.P({transparent:!1,opacity:1}),m=new r.N(c,h);m.position.y=.5,d.add(m),function e(){requestAnimationFrame(e);var t=window.innerWidth/8,o=window.innerHeight/8,d=parseInt(document.getElementById("three-canvas").style.width,10),l=parseInt(document.getElementById("three-canvas").style.height,10),c=document.getElementById("col-canvas").getContext("2d");c.clearRect(0,0,window.innerWidth,window.innerHeight);var h,m,w=new r.gb,v=window.innerHeight/window.innerWidth;if(v>=1){var f=window.innerHeight/300;h=35*f+150*(1-window.innerWidth/window.innerHeight)*f,m=45*f}else if(v>=.75){var y=window.innerWidth/600,E=4*(1-v);h=(-20*E+70*(1-E))*y,m=(65*E+90*(1-E))*y}else{var x=window.innerWidth/300;h=x/2*-20,m=x/1.5*65+(1-v-.25)*(window.innerHeight/2)}if(1!=n.markerEnable);else if(1==n.adjustMode)for(var M=0;M<o;M++)for(var i=0;i<t;i++){var k=8*i,T=8*M,I=1.08*(8*i+h)/d*2-1,C=-.8*(8*M+m)/l*2+1;I=Math.min(Math.max(I,-1),1),C=Math.min(Math.max(C,-1),1);var H=new r.rb(I,C);w.setFromCamera(H,n.camera),w.intersectObjects(n.scene.children,!0).length>0&&(c.beginPath(),c.fillRect(k,T,8,8),c.fillStyle="rgba(0,255,0,0.5)",c.closePath(),c.fill())}else if(2==n.adjustMode)for(var B=0;B<o;B++)for(var j=0;j<t;j++){var R=8*j,S=8*B,rect=document.getElementById("three-canvas").getBoundingClientRect(),W=(8*j-rect.left)*d/rect.width,P=(8*B-rect.top)*l/rect.height,A=1.08*(W/d*2-1),L=.8*(-P/l*2+1);A=Math.min(Math.max(A,-1),1),L=Math.min(Math.max(L,-1),1);var F=new r.rb(A,L);w.setFromCamera(F,n.camera),w.intersectObjects(n.scene.children,!0).length>0&&(c.beginPath(),c.fillRect(R,S,8,8),c.fillStyle="rgba(0,0,255,0.5)",c.closePath(),c.fill())}else for(var z=0;z<o;z++)for(var O=0;O<t;O++){var X=8*O,Y=8*z,D=8*O/d*2-1,J=-8*z/l*2+1;D=Math.min(Math.max(D,-1),1),J=Math.min(Math.max(J,-1),1);var U=new r.rb(D,J);w.setFromCamera(U,n.camera),w.intersectObjects(n.scene.children,!0).length>0&&(c.beginPath(),c.fillRect(X,Y,8,8),c.fillStyle="rgba(255,0,0,0.5)",c.closePath(),c.fill())}}(),document.addEventListener("mousemove",(function(e){var t,o,d,l,c=parseInt(document.getElementById("three-canvas").style.width,10),h=parseInt(document.getElementById("three-canvas").style.height,10),m=window.innerHeight/window.innerWidth;if(m>=1){var w=window.innerHeight/300;d=35*w+150*(1-window.innerWidth/window.innerHeight)*w,l=45*w}else if(m>=.75){var v=window.innerWidth/600,f=4*(1-m);d=(-20*f+70*(1-f))*v,l=(65*f+90*(1-f))*v}else{var y=window.innerWidth/300;d=y/2*-20,l=y/1.5*65+(1-m-.25)*(window.innerHeight/2)}if(1==n.adjustMode)t=1.08*(e.clientX+d)/c*2-1,o=-.8*(e.clientY+l)/h*2+1;else if(2==n.adjustMode){var E=n.getCanvasRelativePosition(e);t=1.08*(E.x/c*2-1),o=.8*(-E.y/h*2+1)}else t=e.clientX/c*2-1,o=-e.clientY/h*2+1;t=Math.min(Math.max(t,-1),1),o=Math.min(Math.max(o,-1),1);var x=new r.rb(t,o),M=new r.gb;M.setFromCamera(x,n.camera),M.intersectObjects(n.scene.children,!0).length>0?document.getElementById("collision-message").innerHTML="collision: box (x:"+t+", y:"+o+") (w:"+window.innerWidth+" h:"+window.innerHeight+")":document.getElementById("collision-message").innerHTML="collision: none (x:"+t+", y:"+o+") (w:"+window.innerWidth+" h:"+window.innerHeight+")"}),!1)},t.getCanvasRelativePosition=function(e){var rect=document.getElementById("three-canvas").getBoundingClientRect(),t=parseInt(document.getElementById("three-canvas").style.width,10),n=parseInt(document.getElementById("three-canvas").style.height,10);return{x:(e.clientX-rect.left)*t/rect.width,y:(e.clientY-rect.top)*n/rect.height}},t.update=function(){this.arToolkitSource.ready&&this.arToolkitContext.update(this.arToolkitSource.domElement)},t.render=function(){this.renderer.render(this.scene,this.camera)},t.animate=function(){requestAnimationFrame(this.animate.bind(this));var e=this.clock.getDelta();this.totalTime+=e,this.update(),this.render(),null!=this.mixer&&this.mixer.update(e)},t.changeAdjustMode=function(){this.adjustMode=this.adjustMode<2?this.adjustMode+1:0,1==this.adjustMode?document.getElementById("collision-message").style.background="#4A4":2==this.adjustMode?document.getElementById("collision-message").style.background="#00afe4":document.getElementById("collision-message").style.background="#444"},e}()}}]);