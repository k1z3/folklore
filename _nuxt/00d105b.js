(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{327:function(e,t,n){"use strict";n.r(t),n.d(t,"AR",(function(){return c}));n(29),n(32),n(51);var o=n(280),r=n(286),c=function(){function e(){this.init(),this.animate()}var t=e.prototype;return t.init=function(){var e=this;this.adjustMode=0,this.gearAction=[],this.clock=new o.l,this.scene=new o.ib;var t=(new o.ob).load("/media-exp-ts/envmap_white.jpg");this.scene.environment=t;var n=new o.ab(16777215,500);n.position.set(-5,0,0),this.scene.add(n),(n=new o.ab(16777215,500)).position.set(5,0,0),this.scene.add(n),(n=new o.ab(16777215,500)).position.set(0,0,8.65),this.scene.add(n),(n=new o.ab(16777215,500)).position.set(0,4.08,0),this.scene.add(n);(new o.o).load(["/media-exp-ts/envmap_white.jpg","/media-exp-ts/envmap_white.jpg","/media-exp-ts/envmap_white.jpg","/media-exp-ts/envmap_white.jpg","/media-exp-ts/envmap_white.jpg","/media-exp-ts/envmap_white.jpg"]).mapping=o.n,this.camera=new o.Z,this.scene.add(this.camera),this.totalTime=0,this.renderer=new o.ub({canvas:document.querySelector("#three-canvas"),antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(new o.m("lightgrey"),0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.outputEncoding=o.t,this.arToolkitContext=new THREEx.ArToolkitContext({cameraParametersUrl:"/media-exp-ts/camera_para.dat"}),this.arToolkitContext.init((function(){e.camera.projectionMatrix.copy(e.arToolkitContext.getProjectionMatrix())}));var c=this;function d(){c.arToolkitSource.onResize(),c.arToolkitSource.copySizeTo(c.renderer.domElement),null!==c.arToolkitContext.arController&&c.arToolkitSource.copySizeTo(c.arToolkitContext.arController.canvas)}this.arToolkitSource=new THREEx.ArToolkitSource({sourceType:"webcam"}),this.arToolkitSource.init((function(){var e=0,t=setInterval((function(){++e>20&&clearInterval(t),d()}),100)})),window.addEventListener("resize",(function(){d()}));var h=new o.u;this.scene.add(h);new THREEx.ArMarkerControls(this.arToolkitContext,h,{type:"pattern",patternUrl:"/media-exp-ts/3Dmarker/hiro.patt",changeMatrixMode:"modelViewMatrix"});function l(e){var t=parseInt(document.getElementById("three-canvas").style.width,10),n=parseInt(document.getElementById("three-canvas").style.height,10),r=c.getCanvasRelativePosition(e),d=1.08*(r.x/t*2-1),h=.8*(-r.y/n*2+1);d=Math.min(Math.max(d,-1),1),h=Math.min(Math.max(h,-1),1);var l=new o.rb(d,h),m=new o.gb;m.setFromCamera(l,c.camera);var w=m.intersectObjects(c.scene.children,!0);console.log(w),w.length>0&&c.gearAction.forEach((function(element){element.play()}))}(new r.a).load("/media-exp-ts/3Dmodels/eventTest/gear.glb",(function(data){var t=data.scene;t.name="gear_model",t.scale.set(.3,.3,.3),t.position.set(0,0,0);var n=data.animations;if(n&&n.length){e.mixer=new o.c(t);for(var i=0;i<n.length;i++){var r=n[i];c.gearAction.push(c.mixer.clipAction(r)),c.gearAction[i].clampWhenFinished=!0}}document.addEventListener("mousedown",l,!1),h.add(t)}))},t.getCanvasRelativePosition=function(e){var rect=document.getElementById("three-canvas").getBoundingClientRect(),t=parseInt(document.getElementById("three-canvas").style.width,10),n=parseInt(document.getElementById("three-canvas").style.height,10);return{x:(e.clientX-rect.left)*t/rect.width,y:(e.clientY-rect.top)*n/rect.height}},t.update=function(){this.arToolkitSource.ready&&this.arToolkitContext.update(this.arToolkitSource.domElement)},t.render=function(){this.renderer.render(this.scene,this.camera)},t.animate=function(){requestAnimationFrame(this.animate.bind(this));var e=this.clock.getDelta();this.totalTime+=e,this.update(),this.render(),null!=this.mixer&&this.mixer.update(e)},e}()}}]);